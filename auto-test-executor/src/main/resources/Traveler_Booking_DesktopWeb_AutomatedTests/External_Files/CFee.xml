<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="638f51a5-166d-436e-b91c-123949c8bcbf" activeEnvironment="Default" name="CFee" resourceRoot="" soapui-version="5.4.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="8b656e45-ac9f-433b-ad28-a51ffe0f81d1" wadlVersion="http://wadl.dev.java.net/2009/02" name="AppConfig" type="rest" basePath="" definitionUrl="D:\WADL\AppConfig_1.wadl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="file:/D:/WADL/AppConfig_1.wadl"><con:part><con:url>file:/D:/WADL/AppConfig_1.wadl</con:url><con:content><![CDATA[<application xmlns="http://wadl.dev.java.net/2009/02">
  <doc xml:lang="en" title="AppConfig"/>
  <resources base="http://">
    <resource path="api/{api_version}/app_config.json" id="app_config.json">
      <doc xml:lang="en" title="app_config.json"/>
      <param name="user_id" default="{user_id}" type="xs:string" required="false" style="query" xmlns:xs="http://www.w3.org/2001/XMLSchema"/>
      <param name="api_version" default="v2" type="xs:string" required="false" style="template" xmlns:xs="http://www.w3.org/2001/XMLSchema"/>
      <method name="GET" id="Method 1">
        <doc xml:lang="en" title="Method 1"/>
        <request/>
      </method>
    </resource>
  </resources>
</application>]]></con:content><con:type>http://wadl.dev.java.net/2009/02</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://</con:endpoint></con:endpoints><con:resource name="app_config.json" path="/api/{api_version}/app_config.json" id="31d6af43-50d4-46a2-8ace-c6c52bad11ab"><con:settings/><con:parameters><con:parameter><con:name>user_id</con:name><con:value>{user_id}</con:value><con:style>QUERY</con:style><con:default>{user_id}</con:default></con:parameter><con:parameter><con:name>api_version</con:name><con:value>v2</con:value><con:style>TEMPLATE</con:style><con:default>v2</con:default></con:parameter><con:parameter><con:name>security_auth_token</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Method 1" id="3156e556-f3b5-4842-af8b-9486f5c39df9" method="GET"><con:settings/><con:parameters/><con:request name="Request 1" id="70f10153-8ade-4a52-8331-032907f3c47c" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request/><con:originalUri>http://null///api/v2/app_config.json</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="security_auth_token" value="ekxnfvoxefmpelbvzuerofqmtcffxxcuwengpdrvwwgrbajkrk" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>user_id</con:entry><con:entry>api_version</con:entry><con:entry>security_auth_token</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="bfa9980a-2393-48cc-8523-d30e95bca642" wadlVersion="http://wadl.dev.java.net/2009/02" name="SIGNIN" type="rest" basePath="" definitionUrl="D:\WADL\SIGNIN_1.wadl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="file:/D:/WADL/SIGNIN_1.wadl"><con:part><con:url>file:/D:/WADL/SIGNIN_1.wadl</con:url><con:content><![CDATA[<application xmlns="http://wadl.dev.java.net/2009/02">
  <doc xml:lang="en" title="SIGNIN"/>
  <resources base="http://}">
    <resource path="users/sign_in" id="sign_in">
      <doc xml:lang="en" title="sign_in"/>
      <method name="POST" id="Method 1">
        <doc xml:lang="en" title="Method 1"/>
        <request/>
      </method>
    </resource>
  </resources>
</application>]]></con:content><con:type>http://wadl.dev.java.net/2009/02</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://}</con:endpoint></con:endpoints><con:resource name="sign_in" path="/users/sign_in" id="bca6744a-d926-4408-a238-a6051552b80b"><con:settings/><con:parameters/><con:method name="Method 1" id="03dc6e93-7a2d-47d0-8ed0-d4958dee20ca" method="POST"><con:settings/><con:parameters/><con:request name="Request 1" id="fa268db1-801a-4c60-b969-17693457405d" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request>{"login_type":"json","user":{"email":"${#TestCase#user_email}","password":"${#TestCase#user_password}"}}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="1960a6d1-ff69-41a9-b968-018f47d06091" wadlVersion="http://wadl.dev.java.net/2009/02" name="CFee" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints/><con:resource name="transaction_response" path="/api/v1/transactions/initialize_transaction" id="9b8d6c90-dcdc-4e2e-87c3-37f4a60481b2"><con:settings/><con:parameters><con:parameter><con:name>requested_trip_id</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>quote_id</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>amount</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>currency</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>api_request</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>security_auth_token</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>payment_id</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Method 1" id="74a732d2-fd24-4541-85a9-810e4c526af4" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html; charset=utf-8</con:mediaType><con:status>404</con:status><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>403</con:status><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>text/html</con:mediaType><con:status>401</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="cd894bd7-791e-4a9a-8fdf-faa8572b27b7" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="amount" value="3825"/>
  <con:entry key="requested_trip_id" value="147723"/>
  <con:entry key="quote_id" value="2640062"/>
  <con:entry key="api_request" value="true"/>
  <con:entry key="currency" value="Rupee"/>
  <con:entry key="security_auth_token" value="ekxnfvoxefmpelbvzuerofqmtcffxxcuwengpdrvwwgrbajkrk"/>
</con:parameters><con:parameterOrder><con:entry>requested_trip_id</con:entry><con:entry>quote_id</con:entry><con:entry>amount</con:entry><con:entry>currency</con:entry><con:entry>api_request</con:entry><con:entry>security_auth_token</con:entry><con:entry>payment_id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="5c02ec51-fab7-4e6e-8ed0-767438e99210" name="User Get The CFee amount"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="5fa95232-7cfb-4649-ae58-bd6bab9e444b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Get The CFee" searchProperties="true"><con:settings/><con:testStep type="calltestcase" name="User logged in" id="a986609c-0691-4d63-9f8d-998af8ad7f1c"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>a6db0a41-3dde-45f5-bbab-f0334ecd37ce</con:targetTestCase><con:properties><con:property><con:name>user_id</con:name><con:value>953268</con:value></con:property><con:property><con:name>Cookie</con:name><con:value>_trips3m_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFVEkiJWNiNTMyZmUxMTc5N2IwZTY1MzBiNzEyZTEwZTE1NDQ4BjsAVEkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsHWwZpA7SLDkkiIiQyYSQxMCQ1dlEzZUU2RjkzUU1QeEdkQnlxZUFlBjsAVEkiDHJlZmVyZXIGOwBUSSIABjsAVA%3D%3D--bd9196ca8aae01fa9b4307e9609b08c0e9d08fe9; path=/; HttpOnly</con:value></con:property><con:property><con:name>hash_key</con:name><con:value/></con:property><con:property><con:name>traveler_apiendpoint</con:name><con:value>new-development.ttdev.in</con:value></con:property><con:property><con:name>user_email</con:name><con:value>lorem_tt_test_ipsum@mailinator.com</con:value></con:property><con:property><con:name>request_url</con:name><con:value/></con:property><con:property><con:name>request_type</con:name><con:value>post</con:value></con:property><con:property><con:name>user_password</con:name><con:value>tt1234</con:value></con:property><con:property><con:name>auth_key</con:name><con:value>75c78998026011e7904f06304046af90</con:value></con:property></con:properties><con:returnProperties><con:entry>user_id</con:entry><con:entry>Cookie</con:entry><con:entry>hash_key</con:entry><con:entry>traveler_apiendpoint</con:entry><con:entry>user_email</con:entry><con:entry>request_url</con:entry><con:entry>request_type</con:entry><con:entry>user_password</con:entry><con:entry>auth_key</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="calltestcase" name="user get the hash key" id="3517396d-7143-4597-bef4-48988cba4a6f"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>718deb1c-e530-4f49-b416-10e897978ddf</con:targetTestCase><con:properties><con:property><con:name>hash_key</con:name><con:value>r3eTdb9ZUi/UuvE72FoR3LmR1R8D3/DZtEMpnzQP2Pg=</con:value></con:property><con:property><con:name>request_url</con:name><con:value>http://${#TestCase#traveler_apiendpoint}/api/v1/transactions/initialize_transaction?requested_trip_id=${#TestCase#requested_trip_id}&amp;quote_id=${#TestCase#quote_id}&amp;amount=${#TestCase#amount}&amp;currency=Rupee&amp;api_request=true&amp;security_auth_token=ekxnfvoxefmpelbvzuerofqmtcffxxcuwengpdrvwwgrbajkrk</con:value></con:property><con:property><con:name>request_type</con:name><con:value>get</con:value></con:property><con:property><con:name>user_email</con:name><con:value>${#TestCase#user_email}</con:value></con:property></con:properties><con:returnProperties><con:entry>hash_key</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="user get the Cfee for a rtrip" id="117e6600-468e-40bd-9e2d-b715316f1a94"><con:settings/><con:config service="CFee" resourcePath="/api/v1/transactions/initialize_transaction" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="user get the Cfee for a rtrip" id="cd894bd7-791e-4a9a-8fdf-faa8572b27b7" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="Cookie" value="${User logged in#Cookie}"/>
  <con:entry key="TT-Mobile" value="${user get the hash key#hash_key}"/>
  <con:entry key="Content-Type" value="application/json;Charset=UTF-8"/>
  <con:entry key="Accept" value="application/json"/>
</xml-fragment>]]></con:setting></con:settings><con:endpoint>http://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request/><con:originalUri>http://null///transactions/transaction_response</con:originalUri><con:assertion type="Simple Contains" id="5e96a357-7cab-40ac-8126-5863a685946c" name="Contains"><con:configuration><token>cfee</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="896677f9-a16b-4ded-9966-1dfef669cf76" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="75baa501-16a9-4c0a-9755-4c290109331b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json_response_holder = new JsonSlurper().parseText(response);

def is_activate = json_response_holder.is_activate;
def charge_value;
try{
charge_value = json_response_holder.dest_charge.CFEE.charge_value;
log.info charge_value 
messageExchange.modelItem.testCase.setPropertyValue("charge_value",String.valueOf(charge_value));

}
catch(Exception e){
	messageExchange.modelItem.testCase.setPropertyValue("charge_value","1");
}


</scriptText></con:configuration></con:assertion><con:credentials><con:username>ttuser</con:username><con:password>ttuser</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>Global HTTP Settings</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="amount" value="${#TestCase#amount}"/>
  <con:entry key="requested_trip_id" value="${#TestCase#requested_trip_id}"/>
  <con:entry key="quote_id" value="${#TestCase#quote_id}"/>
  <con:entry key="api_request" value="true"/>
  <con:entry key="payment_id" value=""/>
  <con:entry key="currency" value="Rupee"/>
  <con:entry key="security_auth_token" value="ekxnfvoxefmpelbvzuerofqmtcffxxcuwengpdrvwwgrbajkrk"/>
</con:parameters><con:parameterOrder><con:entry>requested_trip_id</con:entry><con:entry>quote_id</con:entry><con:entry>amount</con:entry><con:entry>currency</con:entry><con:entry>api_request</con:entry><con:entry>security_auth_token</con:entry><con:entry>payment_id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>requested_trip_id</con:name><con:value>1652227</con:value></con:property><con:property><con:name>quote_id</con:name><con:value>2979330</con:value></con:property><con:property><con:name>traveler_apiendpoint</con:name><con:value>new-development.ttdev.in</con:value></con:property><con:property><con:name>amount</con:name><con:value>3500</con:value></con:property><con:property><con:name>user_email</con:name><con:value>lorem_tt_test_ipsum@mailinator.com</con:value></con:property><con:property><con:name>user_password</con:name><con:value>tt1234</con:value></con:property><con:property><con:name>charge_value</con:name><con:value>500.0</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite id="99e41806-5a08-4dc9-81f2-a19f93299fef" name="LoggedIn"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="a6db0a41-3dde-45f5-bbab-f0334ecd37ce" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="User logged in the application" searchProperties="true"><con:settings/><con:testStep type="calltestcase" name="User get the hash key" id="9d889640-99c9-441e-b93a-3fa84122fcb4"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>718deb1c-e530-4f49-b416-10e897978ddf</con:targetTestCase><con:properties><con:property><con:name>hash_key</con:name><con:value>gUp6B3J76HG0sHO+X9aTMv9O7Dn3ogfLALg4WdFzR2c=</con:value></con:property><con:property><con:name>request_url</con:name><con:value/></con:property><con:property><con:name>request_type</con:name><con:value/></con:property><con:property><con:name>user_email</con:name><con:value>${#TestCase#user_email}</con:value></con:property></con:properties><con:returnProperties><con:entry>hash_key</con:entry><con:entry>request_url</con:entry><con:entry>request_type</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="user logged in with credential" id="2e42d1b3-0306-459d-b4e7-347f5caced32"><con:settings/><con:config service="SIGNIN" resourcePath="/users/sign_in" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="user logged in with credential" id="fa268db1-801a-4c60-b969-17693457405d" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="TT-Mobile-Post" value="${#TestCase#user_email}"/>
  <con:entry key="TT-Mobile" value="${User get the hash key#hash_key}"/>
  <con:entry key="Content-Type" value="application/json;Charset=UTF-8"/>
  <con:entry key="Accept" value="application/json"/>
</xml-fragment>]]></con:setting></con:settings><con:encoding/><con:endpoint>https://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request>{"login_type":"json","user":{"email":"${#TestCase#user_email}","password":"${#TestCase#user_password}"}}</con:request><con:originalUri>https://master.ttdev.in/users/sign_in</con:originalUri><con:assertion type="GroovyScriptAssertion" id="4d022e32-e22b-4bba-b3dd-088de5405478" name="GetUserDetails"><con:configuration><scriptText>import groovy.json.JsonSlurper;

String response = messageExchange.getResponseContent();
def json_response_holder = new JsonSlurper().parseText(response);

String user_id = json_response_holder.current_user.id.toString();

String auth_key = json_response_holder.current_user.pubnub_auth.auth_key;

messageExchange.modelItem.testCase.setPropertyValue("user_id",user_id);

messageExchange.modelItem.testCase.setPropertyValue("auth_key",auth_key);</scriptText></con:configuration></con:assertion><con:assertion type="Simple Contains" id="2ace55d0-5fab-4b35-bf20-6bf92ad16e5b" name="EmailExistInResponse"><con:configuration><token>${#TestCase#user_email}</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="36d9791c-5fe5-4d6c-833d-d3fa43c2153d" name="GetTheResponseCookie"><con:configuration><scriptText>for(String cookie in messageExchange.getResponseHeaders()["Set-Cookie"]){
	if(cookie.contains("_trips3m_session")){
		messageExchange.modelItem.testCase.setPropertyValue("Cookie",cookie);
		messageExchange.modelItem.testCase.testSuite.setPropertyValue("Cookie",cookie);
	}
}</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="e5ecc059-034f-4ca5-acc6-529997d159c1" name="Valid HTTP Status Codes"><con:configuration><codes>200
</codes></con:configuration></con:assertion><con:credentials><con:username>ttuser</con:username><con:password>ttuser</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>Global HTTP Settings</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="Again user get the hash key" id="8c488dab-6017-46a5-94ec-bb2ad16e231d"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>718deb1c-e530-4f49-b416-10e897978ddf</con:targetTestCase><con:properties><con:property><con:name>hash_key</con:name><con:value>uRjgB/HGti4pPSZev/WdEoxpXQFfGvD+Y4foN8mhYLA=</con:value></con:property><con:property><con:name>request_url</con:name><con:value/></con:property><con:property><con:name>request_type</con:name><con:value/></con:property><con:property><con:name>user_email</con:name><con:value/></con:property></con:properties><con:returnProperties><con:entry>hash_key</con:entry><con:entry>request_url</con:entry><con:entry>request_type</con:entry><con:entry>user_email</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="App config is successfully loaded for a user" id="32290389-1460-4b12-a487-af211ac40f87"><con:settings/><con:config service="AppConfig" resourcePath="/api/{api_version}/app_config.json" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="App config is successfully loaded for a user" id="70f10153-8ade-4a52-8331-032907f3c47c" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="TT-Mobile" value="${Again user get the hash key#hash_key}"/>
  &lt;con:entry key="Accept" value="application/json"/>
&lt;/xml-fragment></con:setting></con:settings><con:endpoint>http://${#TestCase#traveler_apiendpoint}</con:endpoint><con:request/><con:originalUri>http://null///api/v2/app_config.json</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="570809f5-0487-48d8-ad39-a1522a34cabb" name="Valid HTTP Status Codes"><con:configuration><codes>200
</codes></con:configuration></con:assertion><con:credentials><con:username>ttuser</con:username><con:password>ttuser</con:password><con:selectedAuthProfile>Basic</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>Global HTTP Settings</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="user_id" value="${#TestCase#user_id}"/>
  <con:entry key="security_auth_token" value="ekxnfvoxefmpelbvzuerofqmtcffxxcuwengpdrvwwgrbajkrk"/>
</con:parameters><con:parameterOrder><con:entry>user_id</con:entry><con:entry>api_version</con:entry><con:entry>security_auth_token</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>user_id</con:name><con:value>953268</con:value></con:property><con:property><con:name>Cookie</con:name><con:value>_trips3m_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFVEkiJTIyNjFjOTMwNDcyYmNjZDZhNGRiYjVkZjQzODdkNzM1BjsAVEkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsHWwZpA7SLDkkiIiQyYSQxMCQ1dlEzZUU2RjkzUU1QeEdkQnlxZUFlBjsAVEkiDHJlZmVyZXIGOwBUSSIABjsAVA%3D%3D--3f1cdab563912f3ae3343fcceffc50d53ab54e1b; path=/; HttpOnly</con:value></con:property><con:property><con:name>hash_key</con:name><con:value/></con:property><con:property><con:name>traveler_apiendpoint</con:name><con:value>new-development.ttdev.in</con:value></con:property><con:property><con:name>user_email</con:name><con:value>lorem_tt_test_ipsum@mailinator.com</con:value></con:property><con:property><con:name>request_url</con:name><con:value/></con:property><con:property><con:name>request_type</con:name><con:value>post</con:value></con:property><con:property><con:name>user_password</con:name><con:value>tt1234</con:value></con:property><con:property><con:name>auth_key</con:name><con:value>75c78998026011e7904f06304046af90</con:value></con:property></con:properties></con:testCase><con:properties><con:property><con:name>Cookie</con:name><con:value>_trips3m_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFVEkiJWNiNTMyZmUxMTc5N2IwZTY1MzBiNzEyZTEwZTE1NDQ4BjsAVEkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsHWwZpA7SLDkkiIiQyYSQxMCQ1dlEzZUU2RjkzUU1QeEdkQnlxZUFlBjsAVEkiDHJlZmVyZXIGOwBUSSIABjsAVA%3D%3D--bd9196ca8aae01fa9b4307e9609b08c0e9d08fe9; path=/; HttpOnly</con:value></con:property></con:properties></con:testSuite><con:testSuite id="74fc8eee-47ed-4ff3-971f-563195b19b09" name="Reusable"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="718deb1c-e530-4f49-b416-10e897978ddf" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="CreateToken" searchProperties="true"><con:settings/><con:testStep type="groovy" name="CT" id="f6ff9a28-b9a8-4b70-907b-e16e3dc6eca3"><con:settings/><con:config><script>import java.security.MessageDigest;
import org.codehaus.groovy.runtime.EncodingGroovyMethods;


String requestUrl = context.expand('${#TestCase#request_url}');
String userEmail = context.expand('${#TestCase#user_email}');
String requestType = context.expand('${#TestCase#request_type}');
log.info requestUrl;
String digest;

if( requestType == "get" ){
  	digest = requestUrl; 
} else {
digest = userEmail + requestType;
}

digest = getUserDigest(digest); //this is final digest

log.info digest;
testRunner.testCase.setPropertyValue("hash_key",digest);

String getUserDigest(String digest) {
   String TT_S_KEY = "DAFAC0A55F50A75558B778035E3C9A8BDF03AF1E4C2124D2CD5DD42092EFD32E";
   try {
       digest = TT_S_KEY + digest;
       MessageDigest msgDigest = MessageDigest.getInstance("SHA-256");
       msgDigest.update(digest.getBytes());
       EncodingGroovyMethods encodeObj = new EncodingGroovyMethods();
       //digest = new String(Base64.encode(msgDigest.digest(), Base64.DEFAULT));
       digest = encodeObj.encodeBase64(msgDigest.digest()).toString();
       if (digest.length() > 164) {
           digest = digest.substring(0, 163);
       }
       return digest;
   } catch (Exception e) {
       log.info e.getMessage();
   }
   return null;
}
</script></con:config></con:testStep><con:properties><con:property><con:name>hash_key</con:name><con:value>uRjgB/HGti4pPSZev/WdEoxpXQFfGvD+Y4foN8mhYLA=</con:value></con:property><con:property><con:name>request_url</con:name><con:value/></con:property><con:property><con:name>request_type</con:name><con:value/></con:property><con:property><con:name>user_email</con:name><con:value/></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>